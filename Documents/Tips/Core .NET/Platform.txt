■プラットフォーム ターゲット
32 ビット用 DLL を [DllImport] で読み込むアプリケーションは動作するか？

○実験の準備
次の 3 種類のコンソール アプリケーションを作成する。

(1) Any CPU
プロジェクトのプロパティで、[プラットフォーム ターゲット] に Any CPU を指定 (既定)
(2) x86
プロジェクトのプロパティで、[プラットフォーム ターゲット] に x86 を指定
(3) x64
プロジェクトのプロパティで、[プラットフォーム ターゲット] に x64 を指定

○実行結果
(i) 32 ビット PC
Any CPU、x86 版は動作する。
x64 版は実行すらできない。
(ii) 64 ビット PC
x86 版は動作する。
Any CPU、x64 版では、BadImageFormatException が発生する。

○64 ビット PC の IIS で Web アプリケーションとして実行するには
アプリケーション プールの [詳細設定...] をクリックして、以下のように設定する。
　32 ビット アプリケーションの有効化: True

○参照
NET Frameworkアプリケーションを64bit OS上で32bitモードで動かす方法
http://niyodiary.cocolog-nifty.com/blog/2009/05/net-framework64.html
